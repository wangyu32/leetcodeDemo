# 分数到小数	
	
	
	
给定两个整数，分别表示分数的分子 numerator 和分母 denominator，以字符串形式返回小数。	
	
如果小数部分为循环小数，则将循环的部分括在括号内。	
	
**示例 1:**	
	
```	
输入: numerator = 1, denominator = 2	
输出: "0.5"	
```	
	
**示例 2:**	
	
```	
输入: numerator = 2, denominator = 1	
输出: "2"	
```	
	
**示例 3:**	
	
```	
输入: numerator = 2, denominator = 3	
输出: "0.(6)"	
```	
	
```java	
	public static String fractionToDecimal(int numerator, int denominator) {	
        long num = numerator;//防止溢出	
        long den = denominator;	
        if (den == 0) return "";	
        if (num == 0) return "0";	
        if (den == 1) return num + "";	
        if (den == -1) return String.valueOf(0 - num);	
	
        boolean nagetive = false;//num与den异号标志	
        if (num > 0 && den < 0) {	
            nagetive = true;	
            den = 0 - den;	
        } else if (num < 0 && den > 0) {	
            nagetive = true;	
            num = 0 - num;	
        } else if (num < 0 && den < 0) {	
            den = 0 - den;	
            num = 0 - num;	
        }	
	
        StringBuilder sb1 = new StringBuilder();	
        //是否异号	
        if(nagetive)	
            sb1.append("-");	
	
        //整数部分	
        sb1.append(num / den);	
	
        //整除	
        if(num % den == 0)	
            return sb1.toString();	
	
        sb1.append(".");	
        num %= den;	
        //除数是2或5时候的快速处理	
        while (num != 0 && den % 2 == 0 || den % 5 == 0) {	
            if (den % 10 == 0)	
                den /= 10;	
            else if (den % 2 == 0) {	
                den /= 2;	
                num *= 5;	
            } else {	
                den /= 5;	
                num *= 2;	
            }	
            sb1.append(num / den);	
            num %= den;	
        }	
	
        //整除	
        if(num % den == 0)	
            return sb1.toString();	
	
        num %= den;	
	
        long reminder = num;//余数	
        StringBuilder sb2 = new StringBuilder();	
        while (true) {	
            reminder *= 10;	
            sb2.append(reminder / den);	
            reminder = reminder % den;	
            if (reminder % den == 0 || reminder == num)	
                break;	
        }	
        if (reminder % den == 0)	
            return sb1.append(sb2).toString();	
        else	
            return sb1.append("(").append(sb2).append(")").toString();	
    }	
	
    //提交答案中网上大神的算法	
    public static String fractionToDecimal4(int numerator, int denominator) {	
        StringBuilder sb1 = new StringBuilder();	
        if (numerator<0&&denominator>0) {	
            sb1.append("-");	
            numerator = -numerator;	
        } else if(numerator>0&&denominator<0) {	
            sb1.append("-");	
            denominator = -denominator;	
        } if(numerator<0&&denominator<0) {	
            numerator = -numerator;	
            denominator = -denominator;	
        }	
        sb1.append( numerator/denominator );	
        if(numerator%denominator==0)	
            return sb1.toString();	
        sb1.append(".");	
        numerator %= denominator;	
        while(numerator!=0&&denominator%2==0||denominator%5==0) {	
            if(denominator%10==0)	
                denominator /= 10;	
            else if(denominator%2==0) {	
                denominator /= 2;	
                numerator *= 5;	
            } else {	
                denominator /= 5;	
                numerator *= 2;	
            }	
            sb1.append(numerator/denominator);	
            numerator %= denominator;	
        }	
        if(numerator%denominator==0)	
            return sb1.toString();	
        numerator %= denominator;	
        long reminder = numerator;	
        StringBuilder sb2 = new StringBuilder();	
        while(true) {	
            reminder *= 10;	
            sb2.append(reminder/denominator);	
            reminder = reminder%denominator;	
            if(reminder%denominator==0||reminder==numerator)	
                break;	
        }	
        if(reminder%denominator==0)	
            return sb1.append(sb2).toString();	
        else	
            return sb1.append("(").append(sb2).append(")").toString();	
    }	
    public static String fractionToDecimal3(int numerator, int denominator) {	
        //5ms 参考 https://segmentfault.com/a/1190000003794677	
        if (denominator == 0) {	
            return "";	
        }	
        if (numerator == 0) {	
            return "0";	
        }	
        long num = numerator;	
        long den = denominator;	
        // 判断结果正负号	
        boolean negative = (num > 0 && den < 0) || (num < 0 && den > 0);	
        num = Math.abs(num);	
        den = Math.abs(den);	
        // 得到整数部分	
        String integ = (negative ? "-" : "") + String.valueOf(num / den);	
        // 如果存在小数部分	
        if(num % den != 0){	
            num = num % den;	
            HashMap<Long, Integer> map = new HashMap<Long, Integer>();	
            int pos = 0;	
            map.put(num, pos);	
            StringBuilder frac = new StringBuilder();	
            // 计算小数部分	
            while(num != 0){	
                // 先把算出的小数加上，再判断余数是否重复，如果余数重复的话，小数会从下一个开始重复	
                num = num * 10;	
                frac.append(num / den);	
                num = num % den;	
                // 如果该余数之前出现过，说明有循环，上次出现的位置到当前位置就是循环的部分	
                if(map.containsKey(num)){	
                    // 将非循环部分和循环部分分开	
                    String pre = frac.substring(0, map.get(num));	
                    String loop = frac.substring(map.get(num));	
                    // 返回有循环的结果	
                    return integ + "." + pre + "(" + loop + ")";	
                }	
                pos++;	
                // 记录下当前余数和他对应小数的位置	
                map.put(num, pos);	
            }	
            // 返回无循环有小数的结果	
            return integ + "." + frac.toString();	
        }	
        // 返回无小数的结果	
        return integ;	
    }	
	
    public static String fractionToDecimal2(int numerator, int denominator) {	
        //初级优化版，参考 https://blog.csdn.net/tiaochewang219/article/details/85641972	
        if (denominator == 0) {	
            return "";	
        }	
        if (numerator == 0) {	
            return "0";	
        }	
        //符号位单独判断-1为负，0为正	
        int flag = (numerator ^ denominator) >> 31;	
        //整数部分的值单独求	
        long num = Math.abs((long) numerator), den = Math.abs((long) denominator);	
        long Int = num / den;//整数	
        long remainder = num % den;//余数	
        StringBuffer res = new StringBuffer();	
        res.append(flag == -1 ? "-" + Int : Int);	
        if (remainder == 0) {//可以整除	
            return res.toString();	
        }	
        //不能整除，先加一个小数点	
        res.append(".");	
        //小数部分单独处理，有能除尽和循环两种情况	
        //是否循环通过Map对应位置来判断	
        //出现循环应当是余数出现和之前相同了	
        Map<Long, Long> map = new LinkedHashMap<Long, Long>();	
        long div = 0;	
        while (remainder != 0) {	
            remainder *= 10;	
            div = remainder / den;//获取商	
            map.put(remainder / 10, div);//将余数和商存入	
            remainder %= den;	
            if (map.containsKey(remainder)) {	
                //出现循环了，将所有循环数括起来	
                //注意此处应当是从循环的位置括起来，而不是开头	
	
                int fla = 0;	
                for (Long key : map.keySet()) {	
                    if (fla == 0 && key != remainder) {	
                        res.append(map.get(key));	
                    }	
                    if (key == remainder) {	
                        fla = 1;	
                        res.append("(");	
                    }	
                    if (fla == 1) {	
                        res.append(map.get(key));	
                    }	
                }	
                res.append(")");	
                return res.toString();	
            }	
        }	
        for (Long key : map.keySet()) {	
            res.append(map.get(key));	
        }	
        return res.toString();	
    }	
	
    public String fractionToDecimal1(int numerator, int denominator) {	
        //初级未优化版，参考 https://blog.csdn.net/qq_41231926/article/details/86475360 易懂	
        long num = numerator;//防止溢出	
        long den = denominator;	
	
        if (den == 0)	
            return "";	
	
        if (num == 0)	
            return "0";	
	
        if (den == 1)	
            return num + "";	
	
        if (den == -1)	
            return String.valueOf(0 - num);	
	
        boolean flag = false;//num与den异号标志	
        if (num > 0 && den < 0) {	
            flag = true;	
            den = 0 - den;	
        } else if (num < 0 && den > 0) {	
            flag = true;	
            num = 0 - num;	
        } else if (num < 0 && den < 0) {	
            den = 0 - den;	
            num = 0 - num;	
        }	
	
        //整除的情况	
        if (num > 0 && num > den && num % den == 0) {	
            return (flag ? "-" : "") + String.valueOf(num / den);	
        }	
	
        long integer = num / den; //整数部分	
        long remainder = num % den; //去除整数部分的余数	
	
        StringBuilder sb = new StringBuilder();//先保存符号位、整数部分、小数点	
        if (flag) {	
            sb.append("-");	
        }	
	
        sb.append(integer).append(".");	
        Map<Long, Long> map = new HashMap<>();//键代表的是被除数，值代表的是余数	
        Set<Long> set = new HashSet<>();//存储重复的被除数	
        StringBuilder decimal = new StringBuilder();//小数部分	
        StringBuilder loop = new StringBuilder();//循环部分	
        while (remainder != 0) {	
            long c = remainder * 10;	
            decimal.append(c / den);	
            map.put(remainder, c % den);	
            remainder = map.get(remainder);	
            if (map.containsKey(remainder)) {	
                if (set.contains(remainder)) {	
                    break;	
                } else {	
                    loop.append(remainder * 10 / den);	
                    set.add(remainder);	
                }	
            }	
        }	
        if (remainder != 0) {	
            return sb.append(decimal.substring(0, decimal.indexOf(loop.toString()))).append("(").append(loop).append(")").toString();	
        } else {	
            return sb.append(decimal).toString();	
        }	
    }	
	
    private void fractionToDecimalPrint(int numerator, int denominator){	
        System.out.println(numerator + "/" + denominator + "=" + fractionToDecimal(numerator, denominator));	
    }	
	
    //判断a，b符号是否相同	
    public static boolean isSamePositiveNegative(int a, int b){	
        return (a ^ b) >> 31 == 0;	
    }	
```	
	
